{
  "active": false,
  "connections": {
    "When clicking \"Test workflow\"": {
      "main": [
        [
          {
            "node": "Вход2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Вход3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Проверка прошедших событий со статусом сегодня на статус завершен",
            "type": "main",
            "index": 0
          },
          {
            "node": "Вход1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion": {
      "main": [
        [
          {
            "node": "Date & Time",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Date & Time": {
      "main": [
        [
          {
            "node": "Через неделю",
            "type": "main",
            "index": 0
          },
          {
            "node": "Через месяц",
            "type": "main",
            "index": 0
          },
          {
            "node": "Через год",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          },
          {
            "node": "Завтра",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Через неделю": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Через месяц": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Через год": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус сегодня": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус прошло": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус в течении месяца": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус в течении года": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус в течении недели": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Завтра": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус Завтра": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Notion1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Получаем завершаемое событие",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Вход": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Вход1": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Вход2": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Notion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Статус в течении года2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Вход3": {
      "main": [
        [
          {
            "node": "Notion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Статус в течении года2": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Проверка прошедших событий со статусом сегодня на статус завершен": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Notion2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion2": {
      "main": [
        [
          {
            "node": "действительно ли события прошли",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Статус сегодня",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Статус прошло",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Статус Завтра",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Статус в течении недели",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Статус в течении месяца",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Статус в течении года",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "действительно ли события прошли": {
      "main": [
        [
          {
            "node": "Проверяем статус",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Тут те события, которые поменяли время исполнения",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Проверяем статус": {
      "main": [
        [
          {
            "node": "не делаем ничего тут все события, получившие статус завершено",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Отправляем напоминание о прошедших но незавершенных событиях",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Получаем завершаемое событие": {
      "main": [
        [
          {
            "node": "проверяем тип",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "проверяем тип": {
      "main": [
        [
          {
            "node": "Статус в течении года3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Если не одноразовое то...",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Если не одноразовое то...": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time1": {
      "main": [
        [
          {
            "node": "Статус в течении года4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Date & Time1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2024-06-13T06:00:05.615Z",
  "id": "jG0KdLDh4FbYzeTo",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Ohronos_back_notion",
  "nodes": [
    {
      "parameters": {},
      "id": "b4c51c3e-4b00-414d-b945-76f1c378ada6",
      "name": "When clicking \"Test workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        720,
        280
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "a22e120b-e389-4d07-8055-316a4c11970a",
          "mode": "list",
          "cachedResultName": "Ohronos_bd",
          "cachedResultUrl": "https://www.notion.so/a22e120be3894d078055316a4c11970a"
        },
        "returnAll": true,
        "filterType": "manual",
        "filters": {
          "conditions": [
            {
              "key": "Статус|select",
              "condition": "does_not_equal",
              "selectValue": "Завершено"
            }
          ]
        },
        "options": {}
      },
      "id": "0c7aaec9-5cb5-4024-a076-b7f15846bc09",
      "name": "Notion",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1320,
        280
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "roundDate",
        "date": "={{ $json.property_.start }}",
        "toNearest": "day",
        "options": {}
      },
      "id": "96c0de99-8be1-44e7-a423-9f6c72c941c0",
      "name": "Date & Time",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        1620,
        280
      ]
    },
    {
      "parameters": {
        "operation": "addToDate",
        "magnitude": "={{ $today }}",
        "timeUnit": "weeks",
        "duration": 1,
        "options": {}
      },
      "id": "9abec505-f40b-4f35-9dc0-77d3a6cd9e16",
      "name": "Через неделю",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        1600,
        0
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "addToDate",
        "magnitude": "={{ $today }}",
        "timeUnit": "months",
        "duration": 1,
        "options": {}
      },
      "id": "ace4dde2-4528-45cf-875e-8f2039fb5014",
      "name": "Через месяц",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        1560,
        -140
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "addToDate",
        "magnitude": "={{ $today }}",
        "timeUnit": "years",
        "duration": 1,
        "options": {}
      },
      "id": "4dcd0317-cb92-4895-9caf-2d24dea0c384",
      "name": "Через год",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        1520,
        -300
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "a1d93723-fc07-447b-98b4-aa65e75ea060",
              "leftValue": false,
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "219f861a-2dfe-4b9a-ba95-0bd5c6d1bfa5",
      "name": "If2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        1780,
        -220
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "Сегодня"
            }
          ]
        },
        "options": {}
      },
      "id": "6a2d5937-90df-4aab-a1ab-cd08cab5b77c",
      "name": "Статус сегодня",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1960,
        -120
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": "",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "Прошло"
            }
          ]
        },
        "options": {}
      },
      "id": "a059369d-6af7-43cb-9e36-fc73fb764ac9",
      "name": "Статус прошло",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2060,
        40
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "6375fe7c-cec9-47e9-9a9e-0fbd15aabc4b",
              "leftValue": "={{ $json.roundedDate }}",
              "rightValue": "={{ $today }}",
              "operator": {
                "type": "dateTime",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "b77350f4-54b8-4858-9afc-5963189a749c",
      "name": "сегодня",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        640,
        80
      ],
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "aca0ed1e-e06f-4861-be25-23d22e35291f",
              "leftValue": "={{ $json.roundedDate }}",
              "rightValue": "={{ $today }}",
              "operator": {
                "type": "dateTime",
                "operation": "before"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "044c5b47-853e-47c0-bbbf-eaaa73e84eae",
      "name": "прошло",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        220,
        120
      ],
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "aca0ed1e-e06f-4861-be25-23d22e35291f",
              "leftValue": "={{ $json.roundedDate }}",
              "rightValue": "={{ $('Через неделю').first().json.newDate }}",
              "operator": {
                "type": "dateTime",
                "operation": "beforeOrEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "d15da55f-0454-4c32-9082-1e601e991012",
      "name": "на неделе",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        400,
        80
      ],
      "disabled": true
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": "",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "В течении месяца"
            }
          ]
        },
        "options": {}
      },
      "id": "9b1368a9-b84e-445c-9e24-f4c491505eff",
      "name": "Статус в течении месяца",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2220,
        440
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": "",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "В течении года"
            }
          ]
        },
        "options": {}
      },
      "id": "d6875b53-d26a-44b7-85f1-5667423cb99a",
      "name": "Статус в течении года",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2280,
        580
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "a1d93723-fc07-447b-98b4-aa65e75ea060",
              "leftValue": false,
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "0af224ed-ffd7-4ac5-9909-ec7416367ec2",
      "name": "If",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        2580,
        220
      ]
    },
    {
      "parameters": {
        "mode": "combine",
        "combinationMode": "mergeByPosition",
        "options": {}
      },
      "id": "09e017ac-224e-4899-94cb-c645d6986949",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2.1,
      "position": [
        1720,
        520
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": "",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "В течении недели"
            }
          ]
        },
        "options": {}
      },
      "id": "0000268d-ee3f-41f4-98c7-e65fdfee24e1",
      "name": "Статус в течении недели",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2180,
        300
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "addToDate",
        "magnitude": "={{ $today }}",
        "duration": 1,
        "options": {}
      },
      "id": "3d5225ea-974e-44bd-ad62-8881be2ea6f5",
      "name": "Завтра",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        1640,
        140
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": "",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "Завтра"
            }
          ]
        },
        "options": {}
      },
      "id": "39d1737f-2de6-47bf-9455-0f861f9c8804",
      "name": "Статус Завтра",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2120,
        160
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "content": "## Распределение статусов в зависимости от удалённости даты начала от сегодняшнего дня.",
        "height": 143.8211086274178,
        "width": 350.16448998759427
      },
      "id": "d4eb1442-7ea8-466e-8b49-ff6591973fe3",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        960,
        100
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "a22e120b-e389-4d07-8055-316a4c11970a",
          "mode": "list",
          "cachedResultName": "Ohronos_bd",
          "cachedResultUrl": "https://www.notion.so/a22e120be3894d078055316a4c11970a"
        },
        "title": "={{ $json['Имя события'] }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Тип события|select",
              "selectValue": "={{ $json['Тип события'] }}"
            },
            {
              "key": "Дата события|date",
              "date": "={{ $json['Дата события'] }}"
            },
            {
              "key": "Периодичность повторения|rich_text",
              "textContent": "={{ $json['Периодичность повторения'] }}"
            },
            {
              "key": "Статус|select",
              "selectValue": "Создано"
            }
          ]
        },
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $json['Заметка'] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "dc8c9d9d-cd61-4b83-975d-f940e1e0f771",
      "name": "Notion1",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1340,
        1060
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "167a7123-7e18-490f-93fd-d5d9507ac77a",
              "name": "Имя события",
              "value": "Название события",
              "type": "string"
            },
            {
              "id": "dc71c3e4-3b88-47c9-ad36-86e3e86b678a",
              "name": "Тип события",
              "value": "Одноразовое",
              "type": "string"
            },
            {
              "id": "d598b927-79b1-496c-bceb-949f8d8a840e",
              "name": "Дата события",
              "value": "2024-08-09T12:00:00.000+03:00",
              "type": "string"
            },
            {
              "id": "2ef22c49-37a9-4fa8-b772-e7587dec92ba",
              "name": "Периодичность повторения",
              "value": "7 дней",
              "type": "string"
            },
            {
              "id": "c1d99b17-57b0-4ea3-b28f-3d08246b78d0",
              "name": "Заметка",
              "value": "Проверить сколько пыли на шкафу возле стены",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "c387761f-0362-42ba-96ea-3a47cfa48369",
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1000,
        1060
      ]
    },
    {
      "parameters": {
        "content": "## Создание события",
        "height": 95.05798747880982,
        "width": 150
      },
      "id": "a886366e-3fa5-4032-96dc-940b7569b3f8",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        960,
        940
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "167a7123-7e18-490f-93fd-d5d9507ac77a",
              "name": "URL события",
              "value": "https://www.notion.so/ab3e049275bf4fc8bd9c180ded5d2370",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "29dd48ad-7631-46dd-936a-931e2903cb22",
      "name": "Edit Fields1",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1000,
        1360
      ]
    },
    {
      "parameters": {},
      "id": "3c254a55-2caa-4fff-a25e-20bc836812f0",
      "name": "Вход",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        800,
        1060
      ]
    },
    {
      "parameters": {},
      "id": "24db517f-9ac2-4131-97c5-603e70b5d5b8",
      "name": "Вход1",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        800,
        1360
      ]
    },
    {
      "parameters": {
        "content": "## Завершение события",
        "height": 91.72762786233855,
        "width": 169.98215769882765
      },
      "id": "b4f158d3-f439-4d5e-bfb3-6b2cf36a5148",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        780,
        1240
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "167a7123-7e18-490f-93fd-d5d9507ac77a",
              "name": "Статус события",
              "value": "Сегодня",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "92d4ee3d-7105-4558-8da8-d89193ff96a0",
      "name": "Edit Fields2",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1280,
        820
      ]
    },
    {
      "parameters": {},
      "id": "6e95d68b-8ef5-4ca4-aca9-dabdeab186cf",
      "name": "Вход2",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        800,
        820
      ]
    },
    {
      "parameters": {
        "content": "## Получение событий по статусу\nПри необходимости получить все события на неделю...месяц...и т.д необходимо отправлять запрос на получение событий включенных в необходимый срок отдельно на каждый статус",
        "height": 91.72762786233855,
        "width": 701.0961942559491
      },
      "id": "6a06b2ae-e80a-4db4-a80d-60458a07e765",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1140,
        720
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "a22e120b-e389-4d07-8055-316a4c11970a",
          "mode": "list",
          "cachedResultName": "Ohronos_bd",
          "cachedResultUrl": "https://www.notion.so/a22e120be3894d078055316a4c11970a"
        },
        "returnAll": true,
        "simple": "",
        "filterType": "manual",
        "filters": {
          "conditions": [
            {
              "key": "Статус|select",
              "condition": "equals",
              "selectValue": "={{ $json['Статус события'] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "cbaf3792-79ed-432c-bf65-c15939ed0cc0",
      "name": "Статус в течении года2",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1700,
        820
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {},
      "id": "22a5c68c-559f-4a55-98fd-98797b694fed",
      "name": "Вход3",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        980,
        280
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f7b9cf9b-641d-4672-9652-4115462ad0c0",
              "name": "Дата события",
              "value": "={{ $json.properties['Дата события'].date.start }}",
              "type": "string"
            },
            {
              "id": "3a845322-87f7-4e97-aed0-8b8628c60ae9",
              "name": "Имя события",
              "value": "={{ $json.properties.Name.title[0].text.content }}",
              "type": "string"
            },
            {
              "id": "54ce8068-46db-4746-9f22-995ad84eae8f",
              "name": "url",
              "value": "={{ $json.url }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "e8985a4d-e144-4f28-8b6e-c32675a803d6",
      "name": "Edit Fields3",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1940,
        820
      ]
    },
    {
      "parameters": {
        "jsCode": "return (\n  [\n  {\n    \"Дата события\": \"2024-06-23T09:36:00.000+03:00\",\n    \"Имя события\": \"Третье событие\",\n    \"url\": \"https://www.notion.so/30f539e9ec3648b68c597fc8d857f24b\"\n  },\n  {\n    \"Дата события\": \"2024-06-23T09:36:07.000+03:00\",\n    \"Имя события\": \"Третье событие\",\n    \"url\": \"https://www.notion.so/ab3e049275bf4fc8bd9c180ded5d2370\"\n  },\n  {\n    \"Дата события\": \"2024-06-23T09:37:00.000+03:00\",\n    \"Имя события\": \"Третье событие\",\n    \"url\": \"https://www.notion.so/f753514c17ad4c4fa8d4e79ed61815da\"\n  },\n  {\n    \"Дата события\": \"2024-06-23T09:38:00.000+03:00\",\n    \"Имя события\": \"Третье событие\",\n    \"url\": \"https://www.notion.so/19522f02dc454032bbbffbce6c86d05a\"\n  },\n  {\n    \"Дата события\": \"2024-06-23T09:38:20.000+03:00\",\n    \"Имя события\": \"Третье событие\",\n    \"url\": \"https://www.notion.so/d84bfbea2d2642dda94a2cc7abeb2b20\"\n  }\n]\n);"
      },
      "id": "d8a5d3ab-1121-4874-be3d-7a52c51ca236",
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -340,
        500
      ]
    },
    {
      "parameters": {},
      "id": "a886a230-78c7-48da-ade6-d7af3b30880e",
      "name": "Проверка прошедших событий со статусом сегодня на статус завершен",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -580,
        500
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": false
      },
      "id": "0afe7180-4754-418f-8d6e-17b917598b85",
      "name": "Notion2",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -620,
        720
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.roundedDate }}",
                    "rightValue": "={{ $today }}",
                    "operator": {
                      "type": "dateTime",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "сегодня"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "450a07e1-e397-46e2-88a9-ded63705cce8",
                    "leftValue": "={{ $json.roundedDate }}",
                    "rightValue": "={{ $today }}",
                    "operator": {
                      "type": "dateTime",
                      "operation": "before"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "прошло"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "770a177c-898b-450f-93ff-fd4423854cd4",
                    "leftValue": "={{ $json.roundedDate }}",
                    "rightValue": "={{ $('Завтра').first().json.newDate }}",
                    "operator": {
                      "type": "dateTime",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "завтра"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "d355651d-a0a0-4271-9df4-1cc60aff47d3",
                    "leftValue": "={{ $json.roundedDate }}",
                    "rightValue": "={{ $('Через неделю').first().json.newDate }}",
                    "operator": {
                      "type": "dateTime",
                      "operation": "beforeOrEquals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "на неделе"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "fc7e71a3-0e85-4eba-8d4a-3efb173958c6",
                    "leftValue": "={{ $json.roundedDate }}",
                    "rightValue": "={{ $('Через месяц').first().json.newDate }}",
                    "operator": {
                      "type": "dateTime",
                      "operation": "beforeOrEquals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "в течении месяца"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "988e5069-30de-469f-bf0c-b33d9569817a",
                    "leftValue": "={{ $json.roundedDate }}",
                    "rightValue": "={{ $('Через год').first().json.newDate }}",
                    "operator": {
                      "type": "dateTime",
                      "operation": "beforeOrEquals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "в течении года"
            }
          ]
        },
        "options": {}
      },
      "id": "c5e973de-3d51-419a-bb85-cc9bb6052076",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        1860,
        180
      ]
    },
    {
      "parameters": {
        "content": "## Проверка прошедших событий со статусом \"сегодня\" на статус \"завершено\".\nДанные должны приходить из дневного таймера, при проверке на устарелость",
        "height": 202.75039909966347,
        "width": 294.2601219341882
      },
      "id": "02844663-3ac8-4e17-aa02-945aa6628ac6",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -160,
        480
      ]
    },
    {
      "parameters": {},
      "id": "79e00ece-3c29-4477-be04-b81635cafc70",
      "name": "не делаем ничего тут все события, получившие статус завершено",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        140,
        680
      ]
    },
    {
      "parameters": {},
      "id": "27be3271-e351-40ee-b8c0-95a7a1ea9ffe",
      "name": "Отправляем напоминание о прошедших но незавершенных событиях",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -20,
        800
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "5aeb306c-4544-4ec0-9d52-312279b61257",
              "leftValue": "={{ $json.properties['Дата события'].date.start }}",
              "rightValue": "={{ $now }}",
              "operator": {
                "type": "dateTime",
                "operation": "before"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "0e814334-7cd9-4f89-89e7-313d3d123ff7",
      "name": "действительно ли события прошли",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -400,
        720
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "0dbd2e53-1d9c-411b-b6c6-6c55e9ebda05",
              "leftValue": "={{ $json.properties['Статус'].select.name }}",
              "rightValue": "Завершено",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "a52561b3-0656-4fb0-81f1-68e2eb3cf267",
      "name": "Проверяем статус",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -180,
        700
      ]
    },
    {
      "parameters": {},
      "id": "db126bb1-caaf-4bbf-8c27-0cd0c1e8267d",
      "name": "Тут те события, которые поменяли время исполнения",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        -400,
        940
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json['URL события'] }}",
          "mode": "url"
        },
        "simple": "",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Статус|select",
              "selectValue": "Завершено"
            }
          ]
        },
        "options": {}
      },
      "id": "60a3e899-d405-4468-b95f-b7a077c0af96",
      "name": "Статус в течении года3",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1760,
        1260
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $json['URL события'] }}",
          "mode": "url",
          "__regex": "(?:https|http)://www.notion.so/(?:[a-z0-9-]{2,}/)?(?:[a-zA-Z0-9-]{2,}-)?([0-9a-f]{8}[0-9a-f]{4}4[0-9a-f]{3}[89ab][0-9a-f]{3}[0-9a-f]{12})"
        },
        "simple": false
      },
      "id": "3f3b4a55-c371-4bcc-83ac-b592b34367a7",
      "name": "Получаем завершаемое событие",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1220,
        1360
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "fb5117a0-64a8-47fd-8f99-7e92103f7fe0",
              "leftValue": "={{ $json.properties['Тип события'].select.name }}",
              "rightValue": "Одноразовое",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "3ebf5d28-46fd-4620-a5c0-92a6094f0843",
      "name": "проверяем тип",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        1440,
        1360
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.properties['Тип события'].select.name }}",
                    "rightValue": "Повторяющееся",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Повторяющееся"
            }
          ]
        },
        "options": {}
      },
      "id": "a11d2345-557f-42de-94f6-8d2be21acc81",
      "name": "Если не одноразовое то...",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        1420,
        1620
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.url }}",
          "mode": "url"
        },
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Дата события|date",
              "date": "={{ $json.newDate }}"
            },
            {
              "key": "Статус|select",
              "selectValue": "Создано"
            }
          ]
        },
        "options": {}
      },
      "id": "7a2d0319-5d22-407b-83af-83d386bdbd27",
      "name": "Статус в течении года4",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2540,
        1580
      ],
      "credentials": {
        "notionApi": {
          "id": "j8RVok2hcJUt51fq",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "addToDate",
        "magnitude": "={{ $now }}",
        "duration": 7,
        "options": {
          "includeInputFields": true
        }
      },
      "id": "18853832-ccb1-4408-8b50-64cba0b95b03",
      "name": "Date & Time1",
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        2340,
        1480
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.properties['Периодичность повторения'].rich_text[0].text.content }}",
                    "rightValue": "неделя",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "неделя"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "8e5d696b-84ab-49e2-92cd-1cd82bbcc98f",
                    "leftValue": "={{ $json.properties['Периодичность повторения'].rich_text[0].text.content }}",
                    "rightValue": "месяц",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "месяц"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "44b98bf7-b090-4413-bd00-74044a7e0a53",
                    "leftValue": "={{ $json.properties['Периодичность повторения'].rich_text[0].text.content }}",
                    "rightValue": "день",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "день"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "bbe78284-9e0a-46a8-991d-12798ee23cb8",
                    "leftValue": "={{ $json.properties['Периодичность повторения'].rich_text[0].text.content }}",
                    "rightValue": "дней",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "...дней"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "24be92e9-acf3-41b0-97d4-4bddd9d05776",
                    "leftValue": "={{ $json.properties['Периодичность повторения'].rich_text[0].text.content }}",
                    "rightValue": "часов",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "...часов"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "822955aa-6f2f-4126-bf15-76a14f641ed5",
      "name": "Switch1",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        1640,
        1600
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "773ec0d3-4fc1-4a88-9b60-1e6089d37700",
      "name": "Edit Fields4",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [
        1960,
        1600
      ]
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-06-16T07:01:41.755Z",
      "updatedAt": "2024-06-16T07:01:41.755Z",
      "id": "eUkZw1ElfnLKRNRp",
      "name": "ohronus"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2024-06-26T06:50:08.000Z",
  "versionId": "a222f062-001f-41af-a4be-7bd4df32a086"
}